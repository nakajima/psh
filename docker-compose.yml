services:
  server:
    build: .
    ports:
      - "3000:3000"
    volumes:
      - ./psh/data:/app/data
      - ./psh/apns:/app/apns:ro
    environment:
      - DATABASE_URL=sqlite:/app/data/data.db?mode=rwc
      - APNS_KEY_PATH=/app/apns/AuthKey.p8
      - APNS_KEY_ID=${APNS_KEY_ID}
      - APNS_TEAM_ID=${APNS_TEAM_ID}
      - APNS_TOPIC=${APNS_TOPIC:-__BUNDLE_ID__}
      - RUST_LOG=${RUST_LOG:-info}
    restart: unless-stopped
